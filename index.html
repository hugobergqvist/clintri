<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ClinTri - Visualization of Clinical Trials</title>

    <link rel="stylesheet" type="text/css" href="css/newMain.css">
    <link rel="stylesheet" type="text/css" href="css/loader.css">
    <link rel="stylesheet" type="text/css" href="css/phaseListStyle.css">
    <link rel="stylesheet" type="text/css" href="css/errormessage.css">
    <link rel="stylesheet" type="text/css" href="css/breadcrumbs.css">
    <link href="https://fonts.googleapis.com/css?family=Montserrat:200,300,400,500&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Comfortaa:300,400,500&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Bitter:400,700&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <script src="https://d3js.org/d3.v4.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/holtzy/D3-graph-gallery@master/LIB/sankey.js"></script>
</head>

<body>
    <div id="logo" class="header">
        <a href="index.html"><img src="./images/logo.svg" class="clintri-logo" alt="ClinTri" /></a>
    </div>

    <div id="logo-extend" class="header">
        <div id="logo-border" style="width:1px; height:50px; background-color: black;"></div>
        <div style="padding-top:5px">
            <span style="font-weight: 400; font-size: 20px; line-height: 0px;">Clinical trials information
                visualization</span>
            <br />
            <span style="font-size: 15px; font-weight: 200;">Based on 300 000+ medical trials</span>
        </div>
    </div>

    <div id="extra" class="header"></div>

    <div id="search-bar" class="">
        <form id="search-form" onsubmit="return false">
            <input id="search-input-text" type="text" placeholder="e.g. breast cancer">
            <input type="submit" onclick="createSankeytree(document.getElementById('search-input-text').value)"
                style="position: absolute; visibility: hidden;">
            <img src="./images/search_icon.svg" class="search-button"
                onclick="createSankeytree(document.getElementById('search-input-text').value)"
                style="position: absolute; right: 25px; align-self: center;" />
            <span
                style="position: absolute; margin-top: -10px; margin-left: 10px; font-family: 'Bitter', serif;">Condition</span>
        </form>

    </div>
    <div id="filter" class="header">
        <div class="filter-hidden" id="filter-button" onclick="toggleFilter()">

            <svg class="" id="filter_icon" xmlns="http://www.w3.org/2000/svg" width="34.568" height="38.043"
                viewBox="0 0 34.568 38.043">
                <g id="noun_Settings_943929" transform="translate(-11.2 -7.3)">
                    <g id="Group_13" data-name="Group 13" transform="translate(11.2 7.3)">
                        <path id="Path_44" data-name="Path 44"
                            d="M44.12,40.921H40.735A5.92,5.92,0,0,0,35.077,36.6a6.07,6.07,0,0,0-5.7,4.321H12.848a1.648,1.648,0,0,0,0,3.3H29.375a5.864,5.864,0,0,0,11.315,0h3.386a1.644,1.644,0,0,0,1.648-1.648A1.58,1.58,0,0,0,44.12,40.921Zm-9.043,4.321A2.68,2.68,0,0,1,32.4,42.569a2.673,2.673,0,0,1,5.346,0A2.68,2.68,0,0,1,35.077,45.242Z"
                            transform="translate(-11.2 -23.548)" />
                        <path id="Path_45" data-name="Path 45"
                            d="M12.848,14.918h3.519a5.864,5.864,0,0,0,11.315,0H44.12a1.644,1.644,0,0,0,1.648-1.648,1.617,1.617,0,0,0-1.648-1.648H27.682a5.864,5.864,0,0,0-11.315,0H12.848A1.644,1.644,0,0,0,11.2,13.269,1.617,1.617,0,0,0,12.848,14.918ZM22.025,10.6A2.68,2.68,0,0,1,24.7,13.269a2.625,2.625,0,0,1-2.673,2.673,2.68,2.68,0,0,1-2.673-2.673A2.74,2.74,0,0,1,22.025,10.6Z"
                            transform="translate(-11.2 -7.3)" />
                        <path id="Path_46" data-name="Path 46"
                            d="M44.12,70.221H27.682a5.864,5.864,0,0,0-11.315,0H12.848A1.644,1.644,0,0,0,11.2,71.869a1.617,1.617,0,0,0,1.648,1.648h3.519a5.864,5.864,0,0,0,11.315,0H44.12a1.644,1.644,0,0,0,1.648-1.648A1.617,1.617,0,0,0,44.12,70.221Zm-22.1,4.321a2.68,2.68,0,0,1-2.673-2.673,2.673,2.673,0,1,1,5.346,0A2.68,2.68,0,0,1,22.025,74.542Z"
                            transform="translate(-11.2 -39.795)" />
                    </g>
                </g>
            </svg>
        </div>
    </div>
    <div id="navigationBreadcrumbs">
        <ul class="breadcrumb">
            <li id="breadcrumbHome" onclick="GoToHome()" class="home boldText">Home</li>
            <li id="breadcrumbSankey" onclick="GoToSankeyTree()" class="hideBreadcrumb">{Sankeytree}</li>
            <li id="breadcrumbList" class="hideBreadcrumb boldText">{List}</li>
            <!-- <li id="breadcrumbStudy" class="hideBreadcrumb">{study}</li> -->
        </ul>
    </div>
    <div class="wrapper" id="content">
        <div id="errorMessage" class="showMessage hideMessage">
            <h1 id="errortext">Condition was not found :( <br /> Please retry with another condition!</h1>
        </div>
        <div id="loader" class="loader hideLoader"><img src="./images/Pulse-1s-200px.gif" alt="loader">
            <div id="loaderCounter"></div>
        </div>

        <div id="tooltip" class="hidden">
            <p><strong id="name"></strong></p>
            <p><span id="value"></span></p>
        </div>
        <!-- <svg id="svgtest"></svg> THIS IS WHAT WILL CONTAIN THE SUNBURST LATER ON!! -->
        <div id="treeMapContainer"></div>
        <div id="sankeyContainer"></div>
        <div id="phaseContentListContainer">
            <table id="phaseTable">
                <thead id="phaseTableHeader">
                    <tr>
                        <th><span id="studyTitle">Study Title </span><input id="studySearch" type="text" value=""
                                placeholder="key search" style="margin-left: 200px;"></input></th>
                        <th>Start Date</th>
                    </tr>
                </thead>
                <tbody id="phaseTableBody">
                    <tr>
                        <td></td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div id="singleStudy">
            <div id="studySideBar">
                <div id="studyIconOne">
                    <svg id="noun_people_2976059" xmlns="http://www.w3.org/2000/svg" width="55" height="25.878" viewBox="0 0 55 25.878">
                        <g id="Group_20" data-name="Group 20" transform="translate(0)">
                          <path id="Path_49" data-name="Path 49" d="M186.117,28a7.845,7.845,0,0,1,7.78,7.794,7.728,7.728,0,0,1-3.347,6.344,12.319,12.319,0,0,1,7.147,7.7,1.145,1.145,0,1,1-2.171.725,9.893,9.893,0,0,0-18.908,0,1.145,1.145,0,1,1-2.171-.725,12.319,12.319,0,0,1,7.147-7.7,7.728,7.728,0,0,1-3.347-6.344A7.864,7.864,0,0,1,186.117,28Zm0,2.356a5.483,5.483,0,1,0,5.428,5.437A5.468,5.468,0,0,0,186.117,30.356Z" transform="translate(-158.572 -25.467)" fill="#fff"/>
                          <path id="Path_50" data-name="Path 50" d="M411.418,0a7.355,7.355,0,0,1,7.328,7.328,7.155,7.155,0,0,1-2.985,5.88,11.3,11.3,0,0,1,6.514,7.237.994.994,0,0,1-.724,1.357,1.053,1.053,0,0,1-1.448-.724,9.121,9.121,0,0,0-8.685-6.423,9.369,9.369,0,0,0-5.519,1.809,1.066,1.066,0,0,1-1.538-.271,1.05,1.05,0,0,1,.181-1.538,11.54,11.54,0,0,1,2.443-1.447A7.155,7.155,0,0,1,404,7.328,7.375,7.375,0,0,1,411.418,0Zm0,2.262a5.067,5.067,0,1,0,4.976,5.066A5.058,5.058,0,0,0,411.418,2.262Z" transform="translate(-367.366)" fill="#fff"/>
                          <path id="Path_51" data-name="Path 51" d="M11.03,2.262a5.067,5.067,0,1,0,4.976,5.066A5.058,5.058,0,0,0,11.03,2.262Zm6.785,12.394A1.05,1.05,0,0,1,18,16.194a1.066,1.066,0,0,1-1.538.271,9.305,9.305,0,0,0-5.428-1.809,9.149,9.149,0,0,0-8.775,6.423A1.053,1.053,0,0,1,.807,21.8a.994.994,0,0,1-.724-1.357A11.3,11.3,0,0,1,6.6,13.208a7.155,7.155,0,0,1-2.985-5.88,7.373,7.373,0,0,1,14.746,0,7.155,7.155,0,0,1-2.985,5.88A11.538,11.538,0,0,1,17.815,14.656Z" transform="translate(0.008)" fill="#fff"/>
                        </g>
                      </svg>                      
                </div>
                <div id="studyTextOne">
                    <span id="singleStudyEnrollmentCount"></span>
                </div>

                <div id="studyIconTwo">
                    <svg xmlns="http://www.w3.org/2000/svg" width="33.667" height="45" viewBox="0 0 33.667 45">
                        <g id="noun_adult_and_child_474181" data-name="noun_adult and child_474181" transform="translate(-186 120)">
                          <g id="Group_28" data-name="Group 28" transform="translate(-73.667 -562)">
                            <g id="Group_27" data-name="Group 27" transform="translate(275 442)">
                              <path id="Path_68" data-name="Path 68" d="M280,487h8.333A1.665,1.665,0,0,0,290,485.333v-15A3.335,3.335,0,0,0,293.333,467V455.333A3.335,3.335,0,0,0,290,452h-1.758a5.833,5.833,0,1,0-8.15,0h-1.758A3.335,3.335,0,0,0,275,455.333V467a3.335,3.335,0,0,0,3.333,3.333v15A1.665,1.665,0,0,0,280,487Zm0-39.167A4.167,4.167,0,1,1,284.167,452,4.17,4.17,0,0,1,280,447.833ZM276.667,467V455.333a1.667,1.667,0,0,1,1.667-1.667H290a1.667,1.667,0,0,1,1.667,1.667V467A1.667,1.667,0,0,1,290,468.667v-10h-1.667v26.667H285V468.667h-1.667v16.667H280V458.667h-1.667v10A1.667,1.667,0,0,1,276.667,467Z" transform="translate(-275 -442)" fill="#fff"/>
                              <path id="Path_69" data-name="Path 69" d="M291.333,480.333h5A1.665,1.665,0,0,0,298,478.667v-8.8A3.318,3.318,0,0,0,299.667,467v-5a3.329,3.329,0,0,0-2.593-3.243,4.122,4.122,0,0,0,.927-2.59,4.167,4.167,0,1,0-8.333,0,4.122,4.122,0,0,0,.927,2.59A3.329,3.329,0,0,0,288,462v5a3.32,3.32,0,0,0,1.667,2.872v8.8A1.665,1.665,0,0,0,291.333,480.333Zm2.5-26.667a2.5,2.5,0,1,1-2.5,2.5A2.5,2.5,0,0,1,293.833,453.667ZM289.667,462a1.667,1.667,0,0,1,1.667-1.667h5A1.667,1.667,0,0,1,298,462v5h-1.667v11.667h-1.667v-8.333H293v8.333h-1.667V467h-1.667Z" transform="translate(-303.333 -435.333)" fill="#fff"/>
                            </g>
                          </g>
                        </g>
                      </svg>
                      
                </div>
                <div id="studyTextTwo">
                    <span id="singleStudyAge">-</span>
                </div>

                <div id="studyIconThree">
                    <svg xmlns="http://www.w3.org/2000/svg" width="50" height="31.915" viewBox="0 0 50 31.915">
                        <g id="noun_Genders_2293867" transform="translate(-126.407 -15.595)">
                          <g id="Group_26" data-name="Group 26" transform="translate(126.407 15.595)">
                            <path id="Path_67" data-name="Path 67" d="M46.856,972.485a1.595,1.595,0,1,0,.166,3.185h.4l-2.838,2.836a13.2,13.2,0,0,0-16.051-.232A13.254,13.254,0,0,0,8.962,996.056l-2.307,2.306-1-1A1.59,1.59,0,1,0,3.4,999.606l1,1.012-1,1a1.593,1.593,0,1,0,2.257,2.239l1-1,1,1a1.593,1.593,0,1,0,2.257-2.239l-1-1,2.291-2.306a13.262,13.262,0,0,0,16.067.249,13.267,13.267,0,0,0,19.569-17.815l2.838-2.836v.415a1.594,1.594,0,0,0,3.187,0v-4.246a1.593,1.593,0,0,0-1.593-1.592H47.022a1.619,1.619,0,0,0-.166,0ZM19.4,977.793a10.043,10.043,0,0,1,6.805,2.654,13.229,13.229,0,0,0-.979,15.659A10.085,10.085,0,1,1,19.4,977.793Zm17,1.062a10.085,10.085,0,1,1-6.805,17.533,13.229,13.229,0,0,0,.979-15.659A10.032,10.032,0,0,1,36.4,978.855ZM28.249,983a10.133,10.133,0,0,1-.7,10.832,10.133,10.133,0,0,1,.7-10.832Z" transform="translate(-2.864 -972.483)" fill="#fff"/>
                          </g>
                        </g>
                      </svg>
                </div>
                <div id="studyTextThree">
                    <span id="singleStudyGender"></span>
                </div>

                <div id="studyIconFour">
                    <svg xmlns="http://www.w3.org/2000/svg" width="36.727" height="37.433" viewBox="0 0 36.727 37.433">
                        <g id="noun_Date_Range_204897" data-name="noun_Date Range_204897" transform="translate(-168 77)">
                          <g id="Group_24" data-name="Group 24" transform="translate(168 -77)">
                            <g id="Group_23" data-name="Group 23" transform="translate(0)">
                              <path id="Path_66" data-name="Path 66" d="M31.418,39.307v-2.82c0-.395-.243-.509-.542-.26L25.6,40.621a.566.566,0,0,0,0,.9l5.272,4.394c.3.25.542.133.542-.26v-2.82h9.889v2.82c0,.393.241.51.542.26l5.273-4.394a.566.566,0,0,0,0-.9l-5.273-4.394c-.3-.249-.542-.135-.542.26v2.82ZM49.076,19.531h2.829a2.826,2.826,0,0,1,2.821,2.832V50.6a2.827,2.827,0,0,1-2.821,2.832H20.821A2.826,2.826,0,0,1,18,50.6V22.364a2.827,2.827,0,0,1,2.821-2.832H23.65v3.526a2.828,2.828,0,0,0,2.832,2.83h1.4a2.828,2.828,0,0,0,2.832-2.83V19.531h11.3v3.526a2.828,2.828,0,0,0,2.832,2.83h1.4a2.828,2.828,0,0,0,2.832-2.83V19.531ZM20.119,31.537a.71.71,0,0,1,.709-.705H51.9a.711.711,0,0,1,.709.705V50.609a.71.71,0,0,1-.709.705H20.828a.711.711,0,0,1-.709-.705Zm4.944-14.118A1.417,1.417,0,0,1,26.474,16h1.416A1.416,1.416,0,0,1,29.3,17.419v5.638a1.417,1.417,0,0,1-1.411,1.419H26.474a1.416,1.416,0,0,1-1.411-1.419Zm18.363,0A1.417,1.417,0,0,1,44.837,16h1.416a1.416,1.416,0,0,1,1.411,1.419v5.638a1.417,1.417,0,0,1-1.411,1.419H44.837a1.416,1.416,0,0,1-1.411-1.419Z" transform="translate(-18 -16)" fill="#fff" fill-rule="evenodd"/>
                            </g>
                          </g>
                        </g>
                      </svg>
                      
                </div>
                <div id="studyTextFourStart">
                    <span id="singleStudyStartDate"></span>           
                </div>
                <div id="studyTextFourFill">to</div>
                <div id="studyTextFourStop">
                    <span id="singleStudyEndDate"></span>
                </div>

                <div id="studyStatusDiv">
                    <span id="singleStudyStatus"></span>
                </div>
            </div>

            <div class="container">
                <div id="studyBar"></div>
                <div id="singleStudyTitleDiv">
                    <h2 id="singleStudyTitle">Study Name</h2>
                    <div>
                        <span id="singleStudyOrganization">Org.</span>
                    </div>
                    
                </div>
                <div id="singleStudyOrg">
                </div>
                <div id="singleStudyAbstractTitle">Abstract</div>
                <div id="singleStudyAbstract">
                    <span id="singleStudyDescription"></span>
                </div>
                <div id="abstractFade"></div>
                <div id="singleStudyButton" >
                        <a id="goToWebsiteButton" target="_blank">Read full study</a>
                </div>
                
        </div>
    </div>

    <!--


        <h2 id="singleStudyTitle">Name of study</h2>
                <p class="singleStudyParagraph"><strong>Start date: </strong><span id="singleStudyStartDate"></span></p>
                <p class="singleStudyParagraph"><strong>End date: </strong><span id="singleStudyEndDate"></span></p>
                <p class="singleStudyParagraph"><strong>Current status: </strong><span id="singleStudyStatus"></span>
                </p>
                <p class="singleStudyParagraph"><strong>Enrollment count: </strong><span
                        id="singleStudyEnrollmentCount"></span></p>
                <p class="singleStudyParagraph"><strong>Gender: </strong><span id="singleStudyGender"></span></p>
                <p class="singleStudyParagraph"><strong>Organization: </strong><span
                        id="singleStudyOrganization"></span></p>
                <p class="singleStudyParagraph"><strong>Description: </strong><span id="singleStudyDescription"></span>
                </p>
                <button><a id="goToWebsiteButton" target="_blank">Go to full study</a></button>
            </div>





    -->

    </div>
    <div class="filter" id="filter-wrapper">
        <div id="filterHeader">
            Filter
        </div>
        <div id="filterOne">Enrollment</div>
        <div id="filterTwo">Gender</div>
        <div id="filterThree">Date</div>
        
    </div>
    <!-- Wrapper div contains the treemap -->
    <div id="sankeyTreeWrapper"></div>

    <script src="script/fetchSingleStudy.js"></script>
    <script src="script/handlingdata.js"></script>
    <script src="script/sankeyTree.js"></script>
    <script src="script/handleSankeytreeData.js"></script>
    <script src="script/createPhaseList.js"></script>
    <script src="script/sunburst.js"></script>
    <script src="script/index.js"></script>
    <div id="timeline">

        <canvas id="canvas2"></canvas>
        <canvas id="canvas"></canvas>
    </div>
</body>

<script>
    document.addEventListener("DOMContentLoaded", modifyIncomingData);    
</script>



<script>

    const ratio = window.devicePixelRatio;
    const c = document.getElementById("canvas");
    const c2 = document.getElementById("canvas2");

    const ctx = c.getContext("2d");
    const ctx2 = c2.getContext("2d");


    c.width = window.innerWidth * ratio;
    c.height = 75 * ratio;
    c.style.width = window.innerWidth + 'px';
    c.style.height = '75px';
    c.style.position = "absolute";


    c2.width = window.innerWidth * ratio;
    c2.height = 75 * ratio;
    c2.style.width = window.innerWidth + 'px';
    c2.style.height = 75;
    c2.style.position = "absolute";

    ctx.scale(ratio, ratio);
    ctx2.scale(ratio, ratio);

    const rect = c.getBoundingClientRect();
    var mousePos = { x: 0, y: 0 }
    var isMovingLeft = false;
    var isMovingRight = false;
    var leftMark = { x: 10 };
    var rightMark = { x: window.innerWidth - 10 };

    var divWidth = window.innerWidth - 20;
    var scaleMarks = { start: 10 + 10, stop: 10 }


    var startDate = new Date(1995, 1, 1, 0, 0, 0)
    var endDate = new Date(2020, 1, 0, 0, 0)
    var currentDate = new Date();
    var spanYears = currentDate.getYear() - startDate.getYear();
    var spanMilliSecond = currentDate - startDate;

    var pixelsPerYear = divWidth / (endDate.getYear() - startDate.getYear())
    console.log("date:", divWidth / pixelsPerYear)

    var startYear = 1995;
    var endYear = 2020;


    function initCanvas() {

        drawMarker();
    }

    function drawScale() {

        var stepsDist = divWidth / spanYears;
        var stepDistSmall = stepsDist / 6;
        for (var i = 0; i < spanYears; i++) {
            ctx2.beginPath();
            if (leftMark.x < divWidth - 18 - (i * stepsDist) && rightMark.x > divWidth - 18 - (i * stepsDist)) {
                ctx2.fillStyle = "rgba(47,47,47,1)";
            } else {
                ctx2.fillStyle = "rgba(183,183,183,1)";
            }

            ctx2.fillRect(divWidth - 18 - (i * stepsDist), 0, 2, 20);
            //ctx2.fillRect(scaleMarks.start + (i*stepsDist),0,2,20);
            ctx2.closePath();
            ctx2.font = "14px Comfortaa";
            ctx2.textAlign = "center";
            ctx2.fillText(endYear - (i * 1), divWidth - 18 - (i * stepsDist), 36);
            //ctx2.fillText(startYear+(i*1), 6+(i*stepsDist), 36);  

            for (var x = 0; x < 6; x++) {
                if (divWidth - 18 - (i * stepsDist) - (x * stepDistSmall) > spanYears) {
                    ctx2.beginPath();
                    if (leftMark.x < divWidth - 18 - (i * stepsDist) - (x * stepDistSmall) && rightMark.x > divWidth - 18 - (i * stepsDist) - (x * stepDistSmall)) {
                        ctx2.fillStyle = "rgba(47,47,47,1)";
                    } else {
                        ctx2.fillStyle = "rgba(183,183,183,1)";
                    }
                    ctx2.fillRect(divWidth - 18 - (i * stepsDist) - (x * stepDistSmall), 0, 1, 15);
                    //ctx2.fillRect(scaleMarks.start + (i*stepsDist)+(x*stepDistSmall),0,1,15);
                    ctx2.closePath();
                }

            }
        }




    }

    function drawMarker() {

        drawScale();
        if(getCurrentPage() !=='HomePage')
        {

        ctx.fillStyle = "#38729F";
        ctx.strokeStyle = "#38729F";

        
        ctx.beginPath();
        //ctx.fillStyle = "#38729F";
        ctx.fillRect(leftMark.x, 0, 6, 55);
        ctx.fillRect(rightMark.x - 6, 0, 6, 55);
        ctx.closePath();

        ctx.beginPath();
        //ctx.strokeStyle = "#38729F";
        ctx.lineWidth = 4;
        ctx.moveTo(leftMark.x, 1);
        ctx.lineTo(rightMark.x, 1);
        ctx.stroke();
        ctx.closePath();

        ctx.beginPath();
        ctx.lineWidth = 14;
        ctx.moveTo(leftMark.x, 55);
        ctx.lineTo(rightMark.x, 55);
        ctx.stroke();
        ctx.closePath();

        ctx.beginPath();
        ctx.moveTo(leftMark.x + 6, 18);
        ctx.lineTo(leftMark.x + 16, 26);
        ctx.lineTo(leftMark.x + 6, 34);
        ctx.fill();
        ctx.closePath();

        ctx.beginPath();
        ctx.moveTo(rightMark.x - 6, 18);
        ctx.lineTo(rightMark.x - 16, 26);
        ctx.lineTo(rightMark.x - 6, 34);
        ctx.fill();
        ctx.closePath();

        }

    }

    c.addEventListener("mousemove", e => {
        mousePos.x = e.clientX - rect.left;
        mousePos.y = e.clientY - rect.top;

        // console.log("span: ", leftMark.x, rightMark.x)

        if (isMovingLeft === true) {


            leftMark.x = mousePos.x;
            //document.getElementById('content').innerHTML = leftMark.x + "-" + rightMark.x;

            ctx.clearRect(0, 0, 2000, 2000);
            ctx2.clearRect(0, 0, 2000, 2000);
            drawMarker();
            updateVis()
        }
        if (isMovingRight === true) {
            rightMark.x = mousePos.x;
            //document.getElementById('content').innerHTML = leftMark.x + "-" + rightMark.x;

            ctx.clearRect(0, 0, 2000, 2000);
            ctx2.clearRect(0, 0, 2000, 2000);
            drawMarker();
            updateVis()
        }
        
    });

    c.addEventListener("mousedown", e => {
        if (Math.abs(mousePos.x - leftMark.x) < 10) {
            isMovingLeft = true;
        }

        if (Math.abs(mousePos.x - rightMark.x) < 10) {
            isMovingRight = true;
        }

    })

    const updateVis = () => {
        if(getCurrentPage() === 'HomePage'){
            console.log('Updating homepage')
        }
        if(getCurrentPage() === 'SankeyPage'){
            console.log('Updating SankeyTree')
            updateSankey();
        }
        if(getCurrentPage() === 'ListPage'){
            console.log('Updating ListPage')
        }
    }

    const updateSankey = () => {

        /*
        let end = new Date()
        let start = new Date()
        start.setDate(start.getDate() - (1000000 / leftMark.x) )
        end.setDate(end.getDate() + (rightMark.x  * 1.1) )
        */

        var leftMarkerYear = (divWidth - 18 - leftMark.x) / pixelsPerYear
        var rightMarkerYear = (divWidth - 18 - rightMark.x) / pixelsPerYear
        var leftMarkMonth = Math.round(12 * (1 - (leftMarkerYear % 1)));
        var rightMarkMonth = Math.round(12 * (1 - (rightMarkerYear % 1)));

        var start = new Date(2020 - Math.ceil(leftMarkerYear), leftMarkMonth, 0, 0, 0);
        var end = new Date(2020 - Math.ceil(rightMarkerYear), rightMarkMonth, 0, 0, 0)
        //console.log("start", start);
        //console.log("end", end)
        /*
        console.log("Left:", leftMark.x)
        console.log("Right:", rightMark.x)
        console.log("Pixels per year:", pixelsPerYear)
        console.log("Left Year:", 2020 - Math.ceil(leftMarkerYear))
        console.log("Right Year:", 2020 - Math.ceil(rightMarkerYear))
        console.log("Left Month:", leftMarkMonth)
        console.log("Right Month:", rightMarkMonth)
        console.log()
        */
        timeFilterSankeyTree(start, end)
    }


    c.addEventListener("mouseup", e => {
        isMovingLeft = false;
        isMovingRight = false;
        //updateSankey()

    })

    initCanvas();
</script>

<script>
    function toggleFilter() {
        document.getElementById("filter-button").classList.toggle("filter-show");
        document.getElementById("filter_icon").classList.toggle("turnWhite");
        //document.getElementById("categorieContainer").classList.toggle("filter-window");
        //document.getElementById("content").classList.toggle("wrapperActiveFilter");
        document.getElementById("filter-wrapper").classList.toggle("show-filter");



        //console.log(document.getElementById("content"))
        //document.getElementById("content").classList.toggle("wrapperActiveFilter");
    }

    //function searchSubmit(searchValue) {
        //document.getElementById('content').innerHTML = searchValue;
    //}
</script>
</body>

</html>